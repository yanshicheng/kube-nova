// Code generated by goctl. DO NOT EDIT.
// versions:
//  goctl version: 1.9.2

package model

import (
	"context"
	"database/sql"
	"fmt"
	"strings"
	"time"

	"github.com/zeromicro/go-zero/core/stores/builder"
	"github.com/zeromicro/go-zero/core/stores/cache"
	"github.com/zeromicro/go-zero/core/stores/sqlc"
	"github.com/zeromicro/go-zero/core/stores/sqlx"
	"github.com/zeromicro/go-zero/core/stringx"
)

var (
	sysUserFieldNames          = builder.RawFieldNames(&SysUser{})
	sysUserRows                = strings.Join(sysUserFieldNames, ",")
	sysUserRowsExpectAutoSet   = strings.Join(stringx.Remove(sysUserFieldNames, "`id`", "`create_at`", "`create_time`", "`created_at`", "`update_at`", "`update_time`", "`updated_at`"), ",")
	sysUserRowsWithPlaceHolder = strings.Join(stringx.Remove(sysUserFieldNames, "`id`", "`create_at`", "`create_time`", "`created_at`", "`update_at`", "`update_time`", "`updated_at`"), "=?,") + "=?"

	cacheKubeNovaSysUserIdPrefix         = "cache:kubeNova:sysUser:id:"
	cacheKubeNovaSysUserDingtalkIdPrefix = "cache:kubeNova:sysUser:dingtalkId:"
	cacheKubeNovaSysUserFeishuIdPrefix   = "cache:kubeNova:sysUser:feishuId:"
	cacheKubeNovaSysUserUsernamePrefix   = "cache:kubeNova:sysUser:username:"
	cacheKubeNovaSysUserWechatIdPrefix   = "cache:kubeNova:sysUser:wechatId:"
)

type (
	sysUserModel interface {
		Insert(ctx context.Context, data *SysUser) (sql.Result, error)
		FindOne(ctx context.Context, id uint64) (*SysUser, error)
		Search(ctx context.Context, orderStr string, isAsc bool, page, pageSize uint64, queryStr string, args ...any) ([]*SysUser, uint64, error)
		SearchNoPage(ctx context.Context, orderStr string, isAsc bool, queryStr string, args ...any) ([]*SysUser, error)
		FindOneByDingtalkId(ctx context.Context, dingtalkId sql.NullString) (*SysUser, error)
		FindOneByFeishuId(ctx context.Context, feishuId sql.NullString) (*SysUser, error)
		FindOneByUsername(ctx context.Context, username string) (*SysUser, error)
		FindOneByWechatId(ctx context.Context, wechatId sql.NullString) (*SysUser, error)
		Update(ctx context.Context, data *SysUser) error
		Delete(ctx context.Context, id uint64) error
		DeleteSoft(ctx context.Context, id uint64) error
		TransCtx(ctx context.Context, fn func(context.Context, sqlx.Session) error) error
		TransOnSql(ctx context.Context, session sqlx.Session, id uint64, sqlStr string, args ...any) (sql.Result, error)
		ExecSql(ctx context.Context, id uint64, sqlStr string, args ...any) (sql.Result, error)
	}

	defaultSysUserModel struct {
		sqlc.CachedConn
		table string
	}

	SysUser struct {
		Id             uint64         `db:"id"`                // 自增主键
		Username       string         `db:"username"`          // 用户名
		Password       string         `db:"password"`          // 密码
		Nickname       string         `db:"nickname"`          // 昵称
		Avatar         string         `db:"avatar"`            // 头像URL
		Email          string         `db:"email"`             // 邮箱
		Phone          string         `db:"phone"`             // 手机号
		WorkNumber     string         `db:"work_number"`       // 工号
		DeptId         uint64         `db:"dept_id"`           // 部门ID
		Status         int64          `db:"status"`            // 状态: 0-禁用, 1-启用
		IsNeedResetPwd int64          `db:"is_need_reset_pwd"` // 是否需要重置密码: 0-否, 1-是
		CreatedBy      string         `db:"created_by"`        // 记录创建人
		UpdatedBy      string         `db:"updated_by"`        // 记录更新人
		CreatedAt      time.Time      `db:"created_at"`        // 创建时间
		UpdatedAt      time.Time      `db:"updated_at"`        // 更新时间
		IsDeleted      int64          `db:"is_deleted"`        // 是否删除（true: 删除， false: 正常）
		DingtalkId     sql.NullString `db:"dingtalk_id"`       // 钉钉用户ID
		WechatId       sql.NullString `db:"wechat_id"`         // 微信用户ID
		FeishuId       sql.NullString `db:"feishu_id"`         // 飞书用户ID
	}
)

func newSysUserModel(conn sqlx.SqlConn, c cache.CacheConf, opts ...cache.Option) *defaultSysUserModel {
	return &defaultSysUserModel{
		CachedConn: sqlc.NewConn(conn, c, opts...),
		table:      "`sys_user`",
	}
}

func (m *defaultSysUserModel) Delete(ctx context.Context, id uint64) error {
	data, err := m.FindOne(ctx, id)
	if err != nil {
		return err
	}

	kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, data.DingtalkId)
	kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, data.FeishuId)
	kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, id)
	kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, data.Username)
	kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, data.WechatId)
	_, err = m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("delete from %s where `id` = ?", m.table)
		return conn.ExecCtx(ctx, query, id)
	}, kubeNovaSysUserDingtalkIdKey, kubeNovaSysUserFeishuIdKey, kubeNovaSysUserIdKey, kubeNovaSysUserUsernameKey, kubeNovaSysUserWechatIdKey)
	return err
}

func (m *defaultSysUserModel) DeleteSoft(ctx context.Context, id uint64) error {
	data, err := m.FindOne(ctx, id)
	if err != nil {
		return err
	}
	// 如果记录已软删除，无需再次删除
	if data.IsDeleted == 1 {
		return nil
	}
	kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, data.DingtalkId)
	kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, data.FeishuId)
	kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, id)
	kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, data.Username)
	kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, data.WechatId)
	_, err = m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("update %s set `is_deleted` = 1 where `id` = ?", m.table)
		return conn.ExecCtx(ctx, query, id)
	}, kubeNovaSysUserDingtalkIdKey, kubeNovaSysUserFeishuIdKey, kubeNovaSysUserIdKey, kubeNovaSysUserUsernameKey, kubeNovaSysUserWechatIdKey)
	return err
}

func (m *defaultSysUserModel) TransCtx(ctx context.Context, fn func(context.Context, sqlx.Session) error) error {
	return m.TransactCtx(ctx, func(ctx context.Context, session sqlx.Session) error {
		return fn(ctx, session)
	})
}

func (m *defaultSysUserModel) TransOnSql(ctx context.Context, session sqlx.Session, id uint64, sqlStr string, args ...any) (sql.Result, error) {
	// 校验 SQL 字符串是否包含表名占位符
	// 如果没有 {table} 占位符，直接使用原始 SQL（兼容直接写表名的情况）
	var query string
	if strings.Contains(sqlStr, "{table}") {
		query = strings.ReplaceAll(sqlStr, "{table}", m.table)
	} else {
		query = sqlStr
	}

	// 如果 id 不为零值并且需要处理缓存逻辑
	if !isZeroValue(id) {

		// 查询数据以获取缓存键（如果需要）
		data, err := m.FindOne(ctx, id)
		if err != nil {
			return nil, err
		}

		// 处理缓存逻辑
		kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, data.DingtalkId)
		kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, data.FeishuId)
		kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, id)
		kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, data.Username)
		kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, data.WechatId)
		// 执行带缓存处理的 SQL 操作
		return m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (sql.Result, error) {
			return session.ExecCtx(ctx, query, args...)
		}, kubeNovaSysUserDingtalkIdKey, kubeNovaSysUserFeishuIdKey, kubeNovaSysUserIdKey, kubeNovaSysUserUsernameKey, kubeNovaSysUserWechatIdKey)

	}

	// 如果 id 为零值，直接通过 session 执行 SQL（无需处理缓存）
	return session.ExecCtx(ctx, query, args...)
}

func (m *defaultSysUserModel) ExecSql(ctx context.Context, id uint64, sqlStr string, args ...any) (sql.Result, error) {
	// 校验 SQL 字符串是否包含表名占位符
	// 如果没有 {table} 占位符，直接使用原始 SQL（兼容直接写表名的情况）
	var query string
	if strings.Contains(sqlStr, "{table}") {
		query = strings.ReplaceAll(sqlStr, "{table}", m.table)
	} else {
		query = sqlStr
	}

	// 如果 id 不为零值并且需要处理缓存逻辑
	if !isZeroValue(id) {

		// 查询数据以获取缓存键（如果需要）
		data, err := m.FindOne(ctx, id)
		if err != nil {
			return nil, err
		}

		// 处理缓存逻辑
		kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, data.DingtalkId)
		kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, data.FeishuId)
		kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, id)
		kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, data.Username)
		kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, data.WechatId)
		// 执行带缓存处理的 SQL 操作
		return m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (sql.Result, error) {
			return conn.ExecCtx(ctx, query, args...)
		}, kubeNovaSysUserDingtalkIdKey, kubeNovaSysUserFeishuIdKey, kubeNovaSysUserIdKey, kubeNovaSysUserUsernameKey, kubeNovaSysUserWechatIdKey)

	}

	// 如果 id 为零值，直接执行 SQL（无需处理缓存）

	return m.ExecNoCacheCtx(ctx, query, args...)

}

func (m *defaultSysUserModel) FindOne(ctx context.Context, id uint64) (*SysUser, error) {
	kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, id)
	var resp SysUser
	err := m.QueryRowCtx(ctx, &resp, kubeNovaSysUserIdKey, func(ctx context.Context, conn sqlx.SqlConn, v any) error {
		query := fmt.Sprintf("select %s from %s where `id` = ? limit 1", sysUserRows, m.table)
		return conn.QueryRowCtx(ctx, v, query, id)
	})
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultSysUserModel) Search(ctx context.Context, orderStr string, isAsc bool, page, pageSize uint64, queryStr string, args ...any) ([]*SysUser, uint64, error) {
	// 确保分页参数有效
	if page < 1 {
		page = 1
	}
	if pageSize < 1 {
		pageSize = 20
	}

	// 构造查询条件
	// 添加 is_deleted = 0 条件，保证只查询未软删除数据
	// 初始化 WHERE 子句，根据数据库类型选择正确的引用符号

	where := "WHERE `is_deleted` = 0"
	if queryStr != "" {
		where = fmt.Sprintf("WHERE %s AND `is_deleted` = 0", queryStr)
	}

	// 根据 isAsc 参数确定排序方式
	sortDirection := "ASC"
	if !isAsc {
		sortDirection = "DESC"
	}

	// 安全处理排序字段，防止 SQL 注入
	// 只允许字母、数字、下划线，并移除危险字符
	if orderStr == "" {
		orderStr = fmt.Sprintf("ORDER BY id %s", sortDirection)
	} else {
		orderStr = strings.TrimSpace(orderStr)
		// 移除可能的 SQL 注入字符：分号、注释符号、引号等
		orderStr = strings.NewReplacer(
			";", "",
			"--", "",
			"/*", "",
			"*/", "",
			"'", "",
			"\"", "",
			"\\", "",
		).Replace(orderStr)

		if !strings.HasPrefix(strings.ToUpper(orderStr), "ORDER BY") {
			orderStr = "ORDER BY " + orderStr
		}
		orderStr = fmt.Sprintf("%s %s", orderStr, sortDirection)
	}

	countQuery := fmt.Sprintf("SELECT COUNT(1) FROM %s %s", m.table, where)

	var total uint64
	var resp []*SysUser
	err := m.QueryRowNoCacheCtx(ctx, &total, countQuery, args...)
	if err != nil {
		return nil, 0, err
	}
	// 搜索无结果是正常情况，返回空切片而非错误
	// 这样上层调用方可以直接判断切片长度，无需额外处理错误
	if total == 0 {
		return []*SysUser{}, 0, nil
	}
	offset := (page - 1) * pageSize

	dataQuery := fmt.Sprintf("SELECT %s FROM %s %s %s LIMIT %d,%d", sysUserRows, m.table, where, orderStr, offset, pageSize)

	err = m.QueryRowsNoCacheCtx(ctx, &resp, dataQuery, args...)
	if err != nil {
		return nil, 0, err
	}

	return resp, total, nil
}

func (m *defaultSysUserModel) SearchNoPage(ctx context.Context, orderStr string, isAsc bool, queryStr string, args ...any) ([]*SysUser, error) {
	// 处理 nil 参数，确保后续操作安全
	if args == nil {
		args = []any{}
	}

	// 初始化 WHERE 子句，根据数据库类型选择正确的引用符号

	where := "WHERE `is_deleted` = 0"

	// 处理查询条件和参数
	var finalArgs []any
	if queryStr != "" {

		where = fmt.Sprintf("WHERE %s AND `is_deleted` = 0", queryStr)

		// 只有当有查询条件时才使用参数
		if len(args) > 0 {
			finalArgs = args
		}
	}

	// 根据 isAsc 参数确定排序方式
	sortDirection := "ASC"
	if !isAsc {
		sortDirection = "DESC"
	}

	// 安全处理排序字段，防止 SQL 注入
	if orderStr == "" {
		orderStr = fmt.Sprintf("ORDER BY id %s", sortDirection)
	} else {
		orderStr = strings.TrimSpace(orderStr)
		// 移除可能的 SQL 注入字符
		orderStr = strings.NewReplacer(
			";", "",
			"--", "",
			"/*", "",
			"*/", "",
			"'", "",
			"\"", "",
			"\\", "",
		).Replace(orderStr)

		if !strings.HasPrefix(strings.ToUpper(orderStr), "ORDER BY") {
			orderStr = "ORDER BY " + orderStr
		}
		orderStr = fmt.Sprintf("%s %s", orderStr, sortDirection)
	}

	dataQuery := fmt.Sprintf("SELECT %s FROM %s %s %s", sysUserRows, m.table, where, orderStr)
	var resp []*SysUser

	// 根据是否有参数来调用，避免传递空参数导致问题
	var err error
	if len(finalArgs) > 0 {
		err = m.QueryRowsNoCacheCtx(ctx, &resp, dataQuery, finalArgs...)
	} else {
		err = m.QueryRowsNoCacheCtx(ctx, &resp, dataQuery)
	}

	switch err {
	case nil:
		// 返回结果，如果无数据则返回空切片
		if resp == nil {
			return []*SysUser{}, nil
		}
		return resp, nil
	case sqlx.ErrNotFound:
		// 无数据时返回空切片而非错误，保持与 Search 方法一致的行为
		return []*SysUser{}, nil
	default:
		return nil, err
	}
}

func (m *defaultSysUserModel) FindOneByDingtalkId(ctx context.Context, dingtalkId sql.NullString) (*SysUser, error) {
	kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, dingtalkId)
	var resp SysUser
	err := m.QueryRowIndexCtx(ctx, &resp, kubeNovaSysUserDingtalkIdKey, m.formatPrimary, func(ctx context.Context, conn sqlx.SqlConn, v any) (i any, e error) {
		query := fmt.Sprintf("select %s from %s where `dingtalk_id` = ? limit 1", sysUserRows, m.table)
		if err := conn.QueryRowCtx(ctx, &resp, query, dingtalkId); err != nil {
			return nil, err
		}
		return resp.Id, nil
	}, m.queryPrimary)
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultSysUserModel) FindOneByFeishuId(ctx context.Context, feishuId sql.NullString) (*SysUser, error) {
	kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, feishuId)
	var resp SysUser
	err := m.QueryRowIndexCtx(ctx, &resp, kubeNovaSysUserFeishuIdKey, m.formatPrimary, func(ctx context.Context, conn sqlx.SqlConn, v any) (i any, e error) {
		query := fmt.Sprintf("select %s from %s where `feishu_id` = ? limit 1", sysUserRows, m.table)
		if err := conn.QueryRowCtx(ctx, &resp, query, feishuId); err != nil {
			return nil, err
		}
		return resp.Id, nil
	}, m.queryPrimary)
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultSysUserModel) FindOneByUsername(ctx context.Context, username string) (*SysUser, error) {
	kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, username)
	var resp SysUser
	err := m.QueryRowIndexCtx(ctx, &resp, kubeNovaSysUserUsernameKey, m.formatPrimary, func(ctx context.Context, conn sqlx.SqlConn, v any) (i any, e error) {
		query := fmt.Sprintf("select %s from %s where `username` = ? limit 1", sysUserRows, m.table)
		if err := conn.QueryRowCtx(ctx, &resp, query, username); err != nil {
			return nil, err
		}
		return resp.Id, nil
	}, m.queryPrimary)
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultSysUserModel) FindOneByWechatId(ctx context.Context, wechatId sql.NullString) (*SysUser, error) {
	kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, wechatId)
	var resp SysUser
	err := m.QueryRowIndexCtx(ctx, &resp, kubeNovaSysUserWechatIdKey, m.formatPrimary, func(ctx context.Context, conn sqlx.SqlConn, v any) (i any, e error) {
		query := fmt.Sprintf("select %s from %s where `wechat_id` = ? limit 1", sysUserRows, m.table)
		if err := conn.QueryRowCtx(ctx, &resp, query, wechatId); err != nil {
			return nil, err
		}
		return resp.Id, nil
	}, m.queryPrimary)
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultSysUserModel) Insert(ctx context.Context, data *SysUser) (sql.Result, error) {
	kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, data.DingtalkId)
	kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, data.FeishuId)
	kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, data.Id)
	kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, data.Username)
	kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, data.WechatId)
	ret, err := m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("insert into %s (%s) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)", m.table, sysUserRowsExpectAutoSet)
		return conn.ExecCtx(ctx, query, data.Username, data.Password, data.Nickname, data.Avatar, data.Email, data.Phone, data.WorkNumber, data.DeptId, data.Status, data.IsNeedResetPwd, data.CreatedBy, data.UpdatedBy, data.IsDeleted, data.DingtalkId, data.WechatId, data.FeishuId)
	}, kubeNovaSysUserDingtalkIdKey, kubeNovaSysUserFeishuIdKey, kubeNovaSysUserIdKey, kubeNovaSysUserUsernameKey, kubeNovaSysUserWechatIdKey)
	return ret, err
}

func (m *defaultSysUserModel) Update(ctx context.Context, newData *SysUser) error {
	data, err := m.FindOne(ctx, newData.Id)
	if err != nil {
		return err
	}

	kubeNovaSysUserDingtalkIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserDingtalkIdPrefix, data.DingtalkId)
	kubeNovaSysUserFeishuIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserFeishuIdPrefix, data.FeishuId)
	kubeNovaSysUserIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, data.Id)
	kubeNovaSysUserUsernameKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserUsernamePrefix, data.Username)
	kubeNovaSysUserWechatIdKey := fmt.Sprintf("%s%v", cacheKubeNovaSysUserWechatIdPrefix, data.WechatId)
	_, err = m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("update %s set %s where `id` = ?", m.table, sysUserRowsWithPlaceHolder)
		return conn.ExecCtx(ctx, query, newData.Username, newData.Password, newData.Nickname, newData.Avatar, newData.Email, newData.Phone, newData.WorkNumber, newData.DeptId, newData.Status, newData.IsNeedResetPwd, newData.CreatedBy, newData.UpdatedBy, newData.IsDeleted, newData.DingtalkId, newData.WechatId, newData.FeishuId, newData.Id)
	}, kubeNovaSysUserDingtalkIdKey, kubeNovaSysUserFeishuIdKey, kubeNovaSysUserIdKey, kubeNovaSysUserUsernameKey, kubeNovaSysUserWechatIdKey)
	return err
}

func (m *defaultSysUserModel) formatPrimary(primary any) string {
	return fmt.Sprintf("%s%v", cacheKubeNovaSysUserIdPrefix, primary)
}

func (m *defaultSysUserModel) queryPrimary(ctx context.Context, conn sqlx.SqlConn, v, primary any) error {
	query := fmt.Sprintf("select %s from %s where `id` = ? limit 1", sysUserRows, m.table)
	return conn.QueryRowCtx(ctx, v, query, primary)
}

func (m *defaultSysUserModel) tableName() string {
	return m.table
}
