// Code generated by goctl. DO NOT EDIT.
// versions:
//  goctl version: 1.7.3

package model

import (
	"context"
	"database/sql"
	"fmt"
	"strings"
	"time"

	"github.com/zeromicro/go-zero/core/stores/builder"
	"github.com/zeromicro/go-zero/core/stores/cache"
	"github.com/zeromicro/go-zero/core/stores/sqlc"
	"github.com/zeromicro/go-zero/core/stores/sqlx"
	"github.com/zeromicro/go-zero/core/stringx"
)

var (
	onecProjectWorkspaceFieldNames          = builder.RawFieldNames(&OnecProjectWorkspace{})
	onecProjectWorkspaceRows                = strings.Join(onecProjectWorkspaceFieldNames, ",")
	onecProjectWorkspaceRowsExpectAutoSet   = strings.Join(stringx.Remove(onecProjectWorkspaceFieldNames, "`id`", "`create_at`", "`create_time`", "`created_at`", "`update_at`", "`update_time`", "`updated_at`"), ",")
	onecProjectWorkspaceRowsWithPlaceHolder = strings.Join(stringx.Remove(onecProjectWorkspaceFieldNames, "`id`", "`create_at`", "`create_time`", "`created_at`", "`update_at`", "`update_time`", "`updated_at`"), "=?,") + "=?"

	cacheIkubeopsOnecProjectWorkspaceIdPrefix                        = "cache:ikubeops:onecProjectWorkspace:id:"
	cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix = "cache:ikubeops:onecProjectWorkspace:projectClusterId:namespace:"
)

type (
	onecProjectWorkspaceModel interface {
		Insert(ctx context.Context, data *OnecProjectWorkspace) (sql.Result, error)

		FindOne(ctx context.Context, id uint64) (*OnecProjectWorkspace, error)
		Search(ctx context.Context, orderStr string, isAsc bool, page, pageSize uint64, queryStr string, args ...any) ([]*OnecProjectWorkspace, uint64, error)
		SearchNoPage(ctx context.Context, orderStr string, isAsc bool, queryStr string, args ...any) ([]*OnecProjectWorkspace, error)
		FindOneByProjectClusterIdNamespace(ctx context.Context, projectClusterId uint64, namespace string) (*OnecProjectWorkspace, error)
		Update(ctx context.Context, data *OnecProjectWorkspace) error
		Delete(ctx context.Context, id uint64) error
		DeleteSoft(ctx context.Context, id uint64) error
		TransCtx(ctx context.Context, fn func(context.Context, sqlx.Session) error) error
		TransOnSql(ctx context.Context, session sqlx.Session, id uint64, sqlStr string, args ...any) (sql.Result, error)
		ExecSql(ctx context.Context, id uint64, sqlStr string, args ...any) (sql.Result, error)
	}

	defaultOnecProjectWorkspaceModel struct {
		sqlc.CachedConn
		table string
	}

	OnecProjectWorkspace struct {
		Id                                      uint64    `db:"id"`                                          // 主键，自增 ID
		ProjectClusterId                        uint64    `db:"project_cluster_id"`                          // 关联到onec_project_cluster
		ClusterUuid                             string    `db:"cluster_uuid"`                                // 关联的集群 ID
		Name                                    string    `db:"name"`                                        // 工作空间中文名称
		Namespace                               string    `db:"namespace"`                                   // 工作空间的唯一标识符（英文，等同于 Kubernetes 的命名空间名称）
		Description                             string    `db:"description"`                                 // 工作空间描述信息
		CpuAllocated                            string    `db:"cpu_allocated"`                               // 分配的 CPU 核心数
		MemAllocated                            string    `db:"mem_allocated"`                               // 分配的内存（单位：GiB）
		StorageAllocated                        string    `db:"storage_allocated"`                           // 分配的 存储 容量
		GpuAllocated                            string    `db:"gpu_allocated"`                               // 分配的 GPU 数量
		PodsAllocated                           int64     `db:"pods_allocated"`                              // 分配的 Pod 数量
		ConfigmapAllocated                      int64     `db:"configmap_allocated"`                         // 分配的 ConfigMap 数量上限
		SecretAllocated                         int64     `db:"secret_allocated"`                            // 分配的 Secret 数量上限
		PvcAllocated                            int64     `db:"pvc_allocated"`                               // 分配的 PVC 数量上限
		EphemeralStorageAllocated               string    `db:"ephemeral_storage_allocated"`                 // 分配的临时存储数量上限
		ServiceAllocated                        int64     `db:"service_allocated"`                           // 分配的 Service 数量上限
		LoadbalancersAllocated                  int64     `db:"loadbalancers_allocated"`                     // 分配的 LoadBalancer 数量上限
		NodeportsAllocated                      int64     `db:"nodeports_allocated"`                         // 分配的 NodePort 数量上限
		DeploymentsAllocated                    int64     `db:"deployments_allocated"`                       // 分配的 Deployment 数量上限
		JobsAllocated                           int64     `db:"jobs_allocated"`                              // 分配的 Job 数量上限
		CronjobsAllocated                       int64     `db:"cronjobs_allocated"`                          // 分配的 CronJob 数量上限
		DaemonsetsAllocated                     int64     `db:"daemonsets_allocated"`                        // 分配的 DaemonSet 数量上限
		StatefulsetsAllocated                   int64     `db:"statefulsets_allocated"`                      // 分配的 StatefulSet 数量上限
		IngressesAllocated                      int64     `db:"ingresses_allocated"`                         // 分配的 Ingress 数量上限
		PodMaxCpu                               string    `db:"pod_max_cpu"`                                 // Pod 级别最大 CPU 限制（单位：核）
		PodMaxMemory                            string    `db:"pod_max_memory"`                              // Pod 级别最大内存限制（单位：GiB）
		PodMaxEphemeralStorage                  string    `db:"pod_max_ephemeral_storage"`                   // Pod 级别最大临时存储限制（单位：GiB）
		PodMinCpu                               string    `db:"pod_min_cpu"`                                 // Pod 级别最小 CPU 请求（单位：核，支持毫核）
		PodMinMemory                            string    `db:"pod_min_memory"`                              // Pod 级别最小内存请求（单位：MiB）
		PodMinEphemeralStorage                  string    `db:"pod_min_ephemeral_storage"`                   // Pod 级别最小临时存储请求（单位：MiB）
		ContainerMaxCpu                         string    `db:"container_max_cpu"`                           // Container 级别最大 CPU 限制（单位：核）
		ContainerMaxMemory                      string    `db:"container_max_memory"`                        // Container 级别最大内存限制（单位：GiB）
		ContainerMaxEphemeralStorage            string    `db:"container_max_ephemeral_storage"`             // Container 级别最大临时存储限制（单位：GiB）
		ContainerMinCpu                         string    `db:"container_min_cpu"`                           // Container 级别最小 CPU 请求（单位：核，支持毫核）
		ContainerMinMemory                      string    `db:"container_min_memory"`                        // Container 级别最小内存请求（单位：MiB）
		ContainerMinEphemeralStorage            string    `db:"container_min_ephemeral_storage"`             // Container 级别最小临时存储请求（单位：MiB）
		ContainerDefaultCpu                     string    `db:"container_default_cpu"`                       // Container 默认 CPU 限制（单位：核）
		ContainerDefaultMemory                  string    `db:"container_default_memory"`                    // Container 默认内存限制（单位：MiB）
		ContainerDefaultEphemeralStorage        string    `db:"container_default_ephemeral_storage"`         // Container 默认临时存储限制（单位：GiB）
		ContainerDefaultRequestCpu              string    `db:"container_default_request_cpu"`               // Container 默认 CPU 请求（单位：核）
		ContainerDefaultRequestMemory           string    `db:"container_default_request_memory"`            // Container 默认内存请求（单位：MiB）
		ContainerDefaultRequestEphemeralStorage string    `db:"container_default_request_ephemeral_storage"` // Container 默认临时存储请求（单位：MiB）
		IsSystem                                int64     `db:"is_system"`                                   // 是否为系统级别项目，如果是则不需要资源限制
		Status                                  int64     `db:"status"`                                      // namespace pod 全是正常则true 否则false 后台管理字段
		AppCreateTime                           time.Time `db:"app_create_time"`                             // 应用创建时间，标识该应用在业务系统中首次创建的时间
		CreatedBy                               string    `db:"created_by"`                                  // 记录创建人
		UpdatedBy                               string    `db:"updated_by"`                                  // 记录最后更新人
		CreatedAt                               time.Time `db:"created_at"`                                  // 记录创建时间
		UpdatedAt                               time.Time `db:"updated_at"`                                  // 记录更新时间
		IsDeleted                               int64     `db:"is_deleted"`                                  // 是否已删除，软删除标记
	}
)

func newOnecProjectWorkspaceModel(conn sqlx.SqlConn, c cache.CacheConf, opts ...cache.Option) *defaultOnecProjectWorkspaceModel {
	return &defaultOnecProjectWorkspaceModel{
		CachedConn: sqlc.NewConn(conn, c, opts...),
		table:      "`onec_project_workspace`",
	}
}

func (m *defaultOnecProjectWorkspaceModel) Delete(ctx context.Context, id uint64) error {
	data, err := m.FindOne(ctx, id)
	if err != nil {
		return err
	}

	ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, id)
	ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, data.ProjectClusterId, data.Namespace)
	_, err = m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("delete from %s where `id` = ?", m.table)
		return conn.ExecCtx(ctx, query, id)
	}, ikubeopsOnecProjectWorkspaceIdKey, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey)
	return err
}

func (m *defaultOnecProjectWorkspaceModel) DeleteSoft(ctx context.Context, id uint64) error {
	data, err := m.FindOne(ctx, id)
	if err != nil {
		return err
	}
	// 如果记录已软删除，无需再次删除
	if data.IsDeleted == 1 {
		return nil
	}
	ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, id)
	ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, data.ProjectClusterId, data.Namespace)
	_, err = m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("update %s set `is_deleted` = 1 where `id` = ?", m.table)
		return conn.ExecCtx(ctx, query, id)
	}, ikubeopsOnecProjectWorkspaceIdKey, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey)
	return err
}

func (m *defaultOnecProjectWorkspaceModel) TransCtx(ctx context.Context, fn func(context.Context, sqlx.Session) error) error {
	return m.TransactCtx(ctx, func(ctx context.Context, session sqlx.Session) error {
		return fn(ctx, session)
	})
}

func (m *defaultOnecProjectWorkspaceModel) TransOnSql(ctx context.Context, session sqlx.Session, id uint64, sqlStr string, args ...any) (sql.Result, error) {
	query := strings.ReplaceAll(sqlStr, "{table}", m.table)
	// 如果 id != 0 并且启用了缓存逻辑
	if !isZeroValue(id) {
		// 查询数据（如果需要，确保数据存在）
		data, err := m.FindOne(ctx, id)
		if err != nil {
			return nil, err
		}

		// 缓存相关处理

		ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, id)
		ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, data.ProjectClusterId, data.Namespace) // 处理缓存逻辑，例如删除或更新缓存
		// 执行带缓存处理的 SQL 操作
		return m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (sql.Result, error) {
			return session.ExecCtx(ctx, query, args...)
		}, ikubeopsOnecProjectWorkspaceIdKey, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey) // 传递缓存相关的键值

	}

	// 如果 id == 0 或不需要缓存，直接执行 SQL
	return m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (sql.Result, error) {
		return session.ExecCtx(ctx, query, args...)
	})
}

func (m *defaultOnecProjectWorkspaceModel) ExecSql(ctx context.Context, id uint64, sqlStr string, args ...any) (sql.Result, error) {
	// 如果 id != 0 并且启用了缓存逻辑
	query := strings.ReplaceAll(sqlStr, "{table}", m.table)
	if !isZeroValue(id) {
		// 缓存相关处理

		// 查询数据（如果需要，确保数据存在）
		data, err := m.FindOne(ctx, id)
		if err != nil {
			return nil, err
		}

		ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, id)
		ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, data.ProjectClusterId, data.Namespace) // 处理缓存逻辑，例如删除或更新缓存
		// 执行带缓存处理的 SQL 操作
		return m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (sql.Result, error) {
			return conn.ExecCtx(ctx, query, args...)
		}, ikubeopsOnecProjectWorkspaceIdKey, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey) // 传递缓存相关的键值

	}

	// 如果 id == 0 或不需要缓存，直接执行 SQL
	return m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (sql.Result, error) {
		return conn.ExecCtx(ctx, query, args...)
	})
}
func (m *defaultOnecProjectWorkspaceModel) FindOne(ctx context.Context, id uint64) (*OnecProjectWorkspace, error) {
	ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, id)
	var resp OnecProjectWorkspace
	err := m.QueryRowCtx(ctx, &resp, ikubeopsOnecProjectWorkspaceIdKey, func(ctx context.Context, conn sqlx.SqlConn, v any) error {
		query := fmt.Sprintf("select %s from %s where `id` = ? AND `is_deleted` = 0 limit 1", onecProjectWorkspaceRows, m.table)
		return conn.QueryRowCtx(ctx, v, query, id)
	})
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultOnecProjectWorkspaceModel) Search(ctx context.Context, orderStr string, isAsc bool, page, pageSize uint64, queryStr string, args ...any) ([]*OnecProjectWorkspace, uint64, error) {
	// 确保分页参数有效
	if page < 1 {
		page = 1
	}
	if pageSize < 1 {
		pageSize = 20
	}

	// 构造查询条件
	// 添加 `is_deleted` = 0 条件，保证只查询未软删除数据
	// 初始化 WHERE 子句
	where := "WHERE `is_deleted` = 0"
	if queryStr != "" {
		where = fmt.Sprintf("WHERE %s AND `is_deleted` = 0", queryStr)
	}

	// 根据 isAsc 参数确定排序方式
	sortDirection := "ASC"
	if !isAsc {
		sortDirection = "DESC"
	}

	// 如果用户未指定排序字段，则默认使用 id
	if orderStr == "" {
		orderStr = fmt.Sprintf("ORDER BY id %s", sortDirection)
	} else {
		orderStr = strings.TrimSpace(orderStr)
		if !strings.HasPrefix(strings.ToUpper(orderStr), "ORDER BY") {
			orderStr = "ORDER BY " + orderStr
		}
		orderStr = fmt.Sprintf("%s %s", orderStr, sortDirection)
	}

	countQuery := fmt.Sprintf("SELECT COUNT(1) FROM %s %s", m.table, where)

	var total uint64
	var resp []*OnecProjectWorkspace
	err := m.QueryRowNoCacheCtx(ctx, &total, countQuery, args...)
	if err != nil {
		return nil, 0, err
	}
	if total == 0 {
		// 无匹配记录
		return resp, 0, ErrNotFound
	}
	offset := (page - 1) * pageSize
	dataQuery := fmt.Sprintf("SELECT %s FROM %s %s %s LIMIT %d,%d", onecProjectWorkspaceRows, m.table, where, orderStr, offset, pageSize)

	err = m.QueryRowsNoCacheCtx(ctx, &resp, dataQuery, args...)
	if err != nil {
		return nil, 0, err
	}

	return resp, total, nil
}

func (m *defaultOnecProjectWorkspaceModel) SearchNoPage(ctx context.Context, orderStr string, isAsc bool, queryStr string, args ...any) ([]*OnecProjectWorkspace, error) {
	// 处理 nil 参数
	if args == nil {
		args = []any{}
	}
	// 初始化 WHERE 子句
	where := "WHERE `is_deleted` = 0"
	// 处理查询条件和参数
	var finalArgs []any
	if queryStr != "" {
		where = fmt.Sprintf("WHERE %s AND `is_deleted` = 0", queryStr)
		// 只有当有查询条件时才使用参数
		if len(args) > 0 {
			finalArgs = args
		}
	}

	// 根据 isAsc 参数确定排序方式
	sortDirection := "ASC"
	if !isAsc {
		sortDirection = "DESC"
	}
	// 如果用户未指定排序字段，则默认使用 id
	if orderStr == "" {
		orderStr = fmt.Sprintf("ORDER BY id %s", sortDirection)
	} else {
		orderStr = strings.TrimSpace(orderStr)
		if !strings.HasPrefix(strings.ToUpper(orderStr), "ORDER BY") {
			orderStr = "ORDER BY " + orderStr
		}
		orderStr = fmt.Sprintf("%s %s", orderStr, sortDirection)
	}
	dataQuery := fmt.Sprintf("SELECT %s FROM %s %s %s", onecProjectWorkspaceRows, m.table, where, orderStr)
	var resp []*OnecProjectWorkspace
	// 根据是否有参数来调用
	var err error
	if len(finalArgs) > 0 {
		err = m.QueryRowsNoCacheCtx(ctx, &resp, dataQuery, finalArgs...)
	} else {
		err = m.QueryRowsNoCacheCtx(ctx, &resp, dataQuery)
	}
	switch err {
	case nil:
		return resp, nil
	case sqlx.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}
func (m *defaultOnecProjectWorkspaceModel) FindOneByProjectClusterIdNamespace(ctx context.Context, projectClusterId uint64, namespace string) (*OnecProjectWorkspace, error) {
	ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, projectClusterId, namespace)
	var resp OnecProjectWorkspace
	err := m.QueryRowIndexCtx(ctx, &resp, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey, m.formatPrimary, func(ctx context.Context, conn sqlx.SqlConn, v any) (i any, e error) {
		query := fmt.Sprintf("select %s from %s where `project_cluster_id` = ? and `namespace` = ? AND `is_deleted` = 0  limit 1", onecProjectWorkspaceRows, m.table)
		if err := conn.QueryRowCtx(ctx, &resp, query, projectClusterId, namespace); err != nil {
			return nil, err
		}
		return resp.Id, nil
	}, m.queryPrimary)
	switch err {
	case nil:
		return &resp, nil
	case sqlc.ErrNotFound:
		return nil, ErrNotFound
	default:
		return nil, err
	}
}

func (m *defaultOnecProjectWorkspaceModel) Insert(ctx context.Context, data *OnecProjectWorkspace) (sql.Result, error) {
	ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, data.Id)
	ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, data.ProjectClusterId, data.Namespace)
	ret, err := m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("insert into %s (%s) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)", m.table, onecProjectWorkspaceRowsExpectAutoSet)
		return conn.ExecCtx(ctx, query, data.ProjectClusterId, data.ClusterUuid, data.Name, data.Namespace, data.Description, data.CpuAllocated, data.MemAllocated, data.StorageAllocated, data.GpuAllocated, data.PodsAllocated, data.ConfigmapAllocated, data.SecretAllocated, data.PvcAllocated, data.EphemeralStorageAllocated, data.ServiceAllocated, data.LoadbalancersAllocated, data.NodeportsAllocated, data.DeploymentsAllocated, data.JobsAllocated, data.CronjobsAllocated, data.DaemonsetsAllocated, data.StatefulsetsAllocated, data.IngressesAllocated, data.PodMaxCpu, data.PodMaxMemory, data.PodMaxEphemeralStorage, data.PodMinCpu, data.PodMinMemory, data.PodMinEphemeralStorage, data.ContainerMaxCpu, data.ContainerMaxMemory, data.ContainerMaxEphemeralStorage, data.ContainerMinCpu, data.ContainerMinMemory, data.ContainerMinEphemeralStorage, data.ContainerDefaultCpu, data.ContainerDefaultMemory, data.ContainerDefaultEphemeralStorage, data.ContainerDefaultRequestCpu, data.ContainerDefaultRequestMemory, data.ContainerDefaultRequestEphemeralStorage, data.IsSystem, data.Status, data.AppCreateTime, data.CreatedBy, data.UpdatedBy, data.IsDeleted)
	}, ikubeopsOnecProjectWorkspaceIdKey, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey)
	return ret, err
}

func (m *defaultOnecProjectWorkspaceModel) Update(ctx context.Context, newData *OnecProjectWorkspace) error {
	data, err := m.FindOne(ctx, newData.Id)
	if err != nil {
		return err
	}

	ikubeopsOnecProjectWorkspaceIdKey := fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, data.Id)
	ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey := fmt.Sprintf("%s%v:%v", cacheIkubeopsOnecProjectWorkspaceProjectClusterIdNamespacePrefix, data.ProjectClusterId, data.Namespace)
	_, err = m.ExecCtx(ctx, func(ctx context.Context, conn sqlx.SqlConn) (result sql.Result, err error) {
		query := fmt.Sprintf("update %s set %s where `id` = ?", m.table, onecProjectWorkspaceRowsWithPlaceHolder)
		return conn.ExecCtx(ctx, query, newData.ProjectClusterId, newData.ClusterUuid, newData.Name, newData.Namespace, newData.Description, newData.CpuAllocated, newData.MemAllocated, newData.StorageAllocated, newData.GpuAllocated, newData.PodsAllocated, newData.ConfigmapAllocated, newData.SecretAllocated, newData.PvcAllocated, newData.EphemeralStorageAllocated, newData.ServiceAllocated, newData.LoadbalancersAllocated, newData.NodeportsAllocated, newData.DeploymentsAllocated, newData.JobsAllocated, newData.CronjobsAllocated, newData.DaemonsetsAllocated, newData.StatefulsetsAllocated, newData.IngressesAllocated, newData.PodMaxCpu, newData.PodMaxMemory, newData.PodMaxEphemeralStorage, newData.PodMinCpu, newData.PodMinMemory, newData.PodMinEphemeralStorage, newData.ContainerMaxCpu, newData.ContainerMaxMemory, newData.ContainerMaxEphemeralStorage, newData.ContainerMinCpu, newData.ContainerMinMemory, newData.ContainerMinEphemeralStorage, newData.ContainerDefaultCpu, newData.ContainerDefaultMemory, newData.ContainerDefaultEphemeralStorage, newData.ContainerDefaultRequestCpu, newData.ContainerDefaultRequestMemory, newData.ContainerDefaultRequestEphemeralStorage, newData.IsSystem, newData.Status, newData.AppCreateTime, newData.CreatedBy, newData.UpdatedBy, newData.IsDeleted, newData.Id)
	}, ikubeopsOnecProjectWorkspaceIdKey, ikubeopsOnecProjectWorkspaceProjectClusterIdNamespaceKey)
	return err
}

func (m *defaultOnecProjectWorkspaceModel) formatPrimary(primary any) string {
	return fmt.Sprintf("%s%v", cacheIkubeopsOnecProjectWorkspaceIdPrefix, primary)
}

func (m *defaultOnecProjectWorkspaceModel) queryPrimary(ctx context.Context, conn sqlx.SqlConn, v, primary any) error {
	query := fmt.Sprintf("select %s from %s where `id` = ? AND `is_deleted` = 0 limit 1", onecProjectWorkspaceRows, m.table)
	return conn.QueryRowCtx(ctx, v, query, primary)
}

func (m *defaultOnecProjectWorkspaceModel) tableName() string {
	return m.table
}
